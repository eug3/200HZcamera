# STM32F103 Project Instructions

## Project Overview
This is an embedded C project for the **STM32F103xB** microcontroller, generated by STM32CubeMX and using the **STM32 HAL (Hardware Abstraction Layer)**.

## Critical Code Placement Rules
**WARNING:** This project uses code generation. To preserve changes during regeneration:
- **ALWAYS** place your code inside the designated `/* USER CODE BEGIN ... */` and `/* USER CODE END ... */` comment blocks.
- **NEVER** modify the auto-generated code outside these blocks (e.g., `SystemClock_Config`, `MX_GPIO_Init` structure) unless explicitly requested and with the understanding it may be overwritten.
- **Example:**
  ```c
  /* USER CODE BEGIN 2 */
  HAL_GPIO_WritePin(Cam_GPIO_Port, Cam_Pin, GPIO_PIN_SET);
  /* USER CODE END 2 */
  ```

## Architecture & File Structure
- **Entry Point:** `Core/Src/main.c` contains `main()`, the infinite loop, and peripheral initialization.
- **Configuration:** `Core/Inc/main.h` defines hardware pin mappings and global constants.
- **Interrupts:** `Core/Src/stm32f1xx_it.c` handles interrupt service routines (ISRs).
- **Drivers:** `Drivers/STM32F1xx_HAL_Driver` contains the HAL library source code. Do not modify these files.

## Build & Workflow
- **Build System:** `Makefile` based.
- **Build Command:** Run `make` in the terminal to build the project.
- **Clean Command:** Run `make clean` to remove build artifacts.
- **Output:** Artifacts (`.elf`, `.hex`, `.bin`) are generated in the `build/` directory.
- **Toolchain:** Requires `arm-none-eabi-gcc`.

## Hardware & Pin Definitions
Refer to `Core/Inc/main.h` for pin definitions. Use these macros instead of raw pin numbers.
- **Camera Pin:** `Cam_Pin` / `Cam_GPIO_Port` (PA8)
- **Wan Pin:** `Wan_Pin` / `Wan_GPIO_Port` (PA9)
- **Tui Pin:** `Tui_Pin` / `Tui_GPIO_Port` (PA10)

## Coding Conventions
- **Error Handling:** Use `Error_Handler()` for critical failures.
- **Types:** Use `stdint.h` types (`uint8_t`, `uint32_t`, etc.) instead of standard `int`/`char`.
- **HAL Usage:** Prefer HAL functions (e.g., `HAL_GPIO_WritePin`, `HAL_Delay`) over direct register access unless performance is critical.
